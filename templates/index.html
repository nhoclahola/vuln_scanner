{% extends "layout.html" %}

{% block title %}Vulnerability Scanner - Trang chủ{% endblock %}

{% block head %}
<style>
    .hero-section {
        background: linear-gradient(135deg, #4a00e0, #8e2de2);
        color: white;
        border-radius: 15px;
        padding: 3rem;
        margin-bottom: 2rem;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
    }
    
    .form-container {
        background-color: white;
        border-radius: 15px;
        padding: 2rem;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    }
    
    .url-input {
        border-radius: 30px;
        padding-left: 1.5rem;
        height: 50px;
    }
    
    .scan-btn {
        border-radius: 30px;
        height: 50px;
        font-weight: bold;
        padding: 0 2rem;
    }
    
    .scan-option, .ai-option {
        cursor: pointer;
        transition: all 0.3s;
        border: 2px solid #f8f9fa;
        border-radius: 15px;
    }
    
    .scan-option:hover, .ai-option:hover {
        transform: translateY(-3px);
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        border-color: #d1d3e2;
    }
    
    .scan-option .card-body, .ai-option .card-body {
        padding: 1.5rem;
    }
    
    input[type="radio"]:checked + .scan-option,
    .scan-option:has(input[type="radio"]:checked),
    .ai-option:has(input[type="radio"]:checked) {
        border-color: #4a00e0;
        background-color: rgba(142, 45, 226, 0.05);
    }
    
    .vulnerability-option {
        display: flex;
        align-items: center;
        margin-bottom: 1rem;
        cursor: pointer;
        padding: 1rem;
        border-radius: 10px;
        transition: all 0.3s;
    }
    
    .vulnerability-option:hover {
        background-color: rgba(142, 45, 226, 0.05);
        transform: translateY(-2px);
    }
    
    .vulnerability-option input[type="checkbox"] {
        transform: scale(1.2);
    }
    
    .vulnerability-icon {
        width: 50px;
        height: 50px;
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
        margin-right: 1rem;
    }
    
    .xss-icon {
        background-color: rgba(220, 53, 69, 0.1);
        color: #dc3545;
    }
    
    .sqli-icon {
        background-color: rgba(255, 193, 7, 0.1);
        color: #ffc107;
    }
    
    .redirect-icon {
        background-color: rgba(13, 110, 253, 0.1);
        color: #0d6efd;
    }
    
    .path-icon {
        background-color: rgba(13, 202, 240, 0.1);
        color: #0dcaf0;
    }
    
    .csrf-icon {
        background-color: rgba(25, 135, 84, 0.1);
        color: #198754;
    }
    
    .vulnerability-description {
        font-size: 0.95rem;
        color: #6c757d;
    }
    
    .usage-section {
        background-color: #f8f9fa;
        border-radius: 15px;
        padding: 2rem;
        margin-top: 2rem;
    }
    
    .usage-step {
        display: flex;
        margin-bottom: 1.5rem;
    }
    
    .step-number {
        width: 36px;
        height: 36px;
        background: linear-gradient(135deg, #4a00e0, #8e2de2);
        color: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        margin-right: 1rem;
        flex-shrink: 0;
    }
</style>
{% endblock %}

{% block content %}
<!-- Hero Section -->
<div class="hero-section">
    <div class="row align-items-center">
        <div class="col-lg-7">
            <h1 class="display-4 fw-bold mb-3">
                <i class="fas fa-shield-alt me-3"></i>Vulnerability Scanner
            </h1>
            <p class="lead mb-4">Công cụ quét lỗ hổng bảo mật tích hợp AI, giúp bạn phát hiện các lỗ hổng trên website một cách nhanh chóng và chính xác.</p>
            <p class="mb-0 d-flex align-items-center">
                <i class="fas fa-check-circle me-2 text-light"></i>
                <span>Quét nhanh chóng</span>
                <span class="mx-3">•</span>
                <i class="fas fa-check-circle me-2 text-light"></i>
                <span>Báo cáo chi tiết</span>
                <span class="mx-3">•</span>
                <i class="fas fa-check-circle me-2 text-light"></i>
                <span>Tích hợp AI</span>
            </p>
        </div>
        <div class="col-lg-5 d-none d-lg-block">
            <div class="text-center">
                <i class="fas fa-search-shield fa-10x opacity-75"></i>
            </div>
        </div>
    </div>
</div>

<!-- Form Container -->
<div class="form-container">
    <form action="{{ url_for('start_scan') }}" method="post" id="scan-form">
        <div class="mb-4">
            <h4 class="mb-3">Nhập URL website cần quét</h4>
            <div class="input-group mb-3">
                <span class="input-group-text bg-transparent border-end-0">
                    <i class="fas fa-globe"></i>
                </span>
                <input type="url" class="form-control url-input border-start-0" name="url" placeholder="https://example.com" required>
            </div>
            <small class="text-muted">
                <i class="fas fa-info-circle me-1"></i>
                Nhập URL đầy đủ bao gồm cả http:// hoặc https://
            </small>
        </div>
        
        <h4 class="mb-3">Chọn loại quét</h4>
        <div class="row mb-4">
            <div class="col-md-6">
                <div class="card scan-option h-100" onclick="document.getElementById('basic_scan').checked = true;">
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <h5 class="card-title mb-0">
                                <i class="fas fa-tachometer-alt me-2 text-primary"></i>Quét cơ bản
                            </h5>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="scan_type" id="basic_scan" value="basic" checked>
                            </div>
                        </div>
                        <p class="card-text text-muted">Quét nhanh, tìm các lỗ hổng phổ biến nhất:</p>
                        <ul class="list-unstyled">
                            <li><i class="fas fa-check-circle text-success me-2"></i>Cross-Site Scripting (XSS)</li>
                            <li><i class="fas fa-check-circle text-success me-2"></i>SQL Injection</li>
                            <li><i class="fas fa-check-circle text-success me-2"></i>HTTP Headers Analysis</li>
                        </ul>
                        <p class="card-text"><small class="text-muted">Thời gian: 5-15 phút</small></p>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card scan-option h-100" onclick="document.getElementById('full_scan').checked = true;">
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <h5 class="card-title mb-0">
                                <i class="fas fa-shield-alt me-2 text-danger"></i>Quét toàn diện
                            </h5>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="scan_type" id="full_scan" value="full">
                            </div>
                        </div>
                        <p class="card-text text-muted">Phân tích sâu, tìm tất cả lỗ hổng:</p>
                        <ul class="list-unstyled">
                            <li><i class="fas fa-check-circle text-success me-2"></i>Tất cả các lỗ hổng trong quét cơ bản</li>
                            <li><i class="fas fa-check-circle text-success me-2"></i>Open Redirect</li>
                            <li><i class="fas fa-check-circle text-success me-2"></i>Path Traversal</li>
                            <li><i class="fas fa-check-circle text-success me-2"></i>Cross-Site Request Forgery (CSRF)</li>
                            <li><i class="fas fa-check-circle text-success me-2"></i>SSL/TLS Analysis</li>
                            <li><i class="fas fa-check-circle text-success me-2"></i>CMS Detection</li>
                        </ul>
                        <p class="card-text"><small class="text-muted">Thời gian: 15-30 phút</small></p>
                    </div>
                </div>
            </div>
        </div>
        
        <h4 class="mb-3">Mô hình AI</h4>
        <div class="row mb-4">
            <div class="col-md-12">
                <div class="card ai-option h-100">
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <h5 class="card-title mb-0">
                                <i class="fas fa-brain me-2 text-primary"></i>DeepSeek AI
                            </h5>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="use_deepseek" id="use_deepseek" value="true" checked hidden>
                            </div>
                        </div>
                        <p class="card-text text-muted">Sử dụng DeepSeek Chat - mô hình AI hiệu năng cao</p>
                        <ul class="list-unstyled">
                            <li><i class="fas fa-check-circle text-success me-2"></i>Context window 128K tokens</li>
                            <li><i class="fas fa-check-circle text-success me-2"></i>Xử lý tốt các website phức tạp</li>
                            <li><i class="fas fa-check-circle text-success me-2"></i>Phân tích sâu mã nguồn</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="text-center mt-4">
            <button type="submit" class="btn btn-primary scan-btn">
                <i class="fas fa-search me-2"></i>Bắt đầu quét
            </button>
        </div>
    </form>
</div>

<!-- Phần hướng dẫn -->
<div class="usage-section mt-4">
    <h4 class="mb-4"><i class="fas fa-info-circle me-2"></i>Hướng dẫn sử dụng</h4>
    
    <div class="usage-step">
        <div class="step-number">1</div>
        <div>
            <h5>Nhập URL</h5>
            <p class="text-muted">Nhập URL đầy đủ của website cần quét bao gồm cả phần http:// hoặc https://</p>
        </div>
    </div>
    
    <div class="usage-step">
        <div class="step-number">2</div>
        <div>
            <h5>Chọn loại quét</h5>
            <p class="text-muted">Chọn quét cơ bản cho việc kiểm tra nhanh hoặc quét toàn diện để phân tích sâu hơn.</p>
        </div>
    </div>
    
    <div class="usage-step">
        <div class="step-number">3</div>
        <div>
            <h5>Bấm "Bắt đầu quét"</h5>
            <p class="text-muted">Hệ thống sẽ sử dụng DeepSeek AI để thực hiện quá trình quét lỗ hổng.</p>
        </div>
    </div>
    
    <div class="usage-step">
        <div class="step-number">4</div>
        <div>
            <h5>Xem kết quả</h5>
            <p class="text-muted">Sau khi quét hoàn tất, bạn sẽ nhận được báo cáo chi tiết về các lỗ hổng được phát hiện.</p>
        </div>
    </div>
    
    <div class="alert alert-info">
        <i class="fas fa-lightbulb me-2"></i>
        <strong>Lưu ý:</strong> Quét toàn diện sẽ mất nhiều thời gian hơn nhưng phát hiện nhiều lỗ hổng hơn. Nếu bạn cần kết quả nhanh, hãy chọn quét cơ bản.
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    $(document).ready(function() {
        // Form validation
        $('#scan-form').submit(function(e) {
            // Check if URL is valid
            var url = $('input[name="url"]').val();
            if (!url.match(/^(http|https):\/\/[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,}(:[0-9]{1,5})?(\/.*)?$/i)) {
                e.preventDefault();
                alert('Vui lòng nhập một URL hợp lệ (bao gồm http:// hoặc https://)');
                return false;
            }
            
            // Show loading state
            $(this).find('button[type="submit"]').html('<span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span> Đang bắt đầu quét...');
            $(this).find('button[type="submit"]').prop('disabled', true);
            
            return true;
        });
    });

    document.addEventListener('DOMContentLoaded', function() {
        // Xử lý chọn loại quét
        const basicScanOption = document.querySelector('.scan-option:nth-child(1)');
        const fullScanOption = document.querySelector('.scan-option:nth-child(2)');
        const basicRadio = document.getElementById('basic_scan');
        const fullRadio = document.getElementById('full_scan');
        
        if (basicScanOption && fullScanOption) {
            basicScanOption.addEventListener('click', function() {
                basicRadio.checked = true;
            });
            
            fullScanOption.addEventListener('click', function() {
                fullRadio.checked = true;
            });
        }
    });
</script>
{% endblock %} 